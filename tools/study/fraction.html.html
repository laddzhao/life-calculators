<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>分数计算器 - 生活计算宝典</title>
    <link rel="stylesheet" href="../../style.css">
    <link rel="stylesheet" href="../../layout.css">
    <link rel="stylesheet" href="../../components.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="../../favicon.ico" type="image/x-icon">
</head>
<body class="app">
    <header class="app-header">
        <div class="container">
            <nav class="navbar">
                <div class="navbar-mobile">
                    <a href="../../pages/study.html" class="navbar-back">
                        <i class="fas fa-arrow-left"></i>
                    </a>
                    <div class="navbar-title">分数计算器</div>
                    <div></div>
                </div>
                
                <div class="navbar-desktop">
                    <a href="../../index.html" class="logo">
                        <i class="fas fa-calculator"></i>
                        <span class="logo-text">生活计算宝典</span>
                    </a>
                    <div class="nav-links">
                        <a href="../../index.html" class="nav-link">首页</a>
                        <a href="../../pages/study.html" class="nav-link active">学习工具</a>
                        <a href="../../pages/tools.html" class="nav-link">所有工具</a>
                    </div>
                    <div class="theme-toggle">
                        <button class="theme-btn" aria-label="切换主题">
                            <i class="fas fa-moon"></i>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="app-main">
        <section class="section">
            <div class="container">
                <!-- 面包屑导航 -->
                <nav class="breadcrumb">
                    <a href="../../index.html" class="breadcrumb-link">首页</a>
                    <span class="breadcrumb-divider"><i class="fas fa-chevron-right"></i></span>
                    <a href="../../pages/study.html" class="breadcrumb-link">学习工具</a>
                    <span class="breadcrumb-divider"><i class="fas fa-chevron-right"></i></span>
                    <span class="breadcrumb-current">分数计算器</span>
                </nav>
                
                <!-- 计算器容器 -->
                <div class="calculator-container">
                    <div class="calculator-card">
                        <div class="calculator-header">
                            <h1 class="calculator-title">分数计算器</h1>
                            <p class="calculator-description">
                                专业的分数计算工具，支持分数加减乘除、约分和通分计算。
                            </p>
                        </div>
                        
                        <!-- 计算模式选择 -->
                        <div class="tabs" id="fractionModeTabs">
                            <button class="tab active" data-mode="arithmetic">分数运算</button>
                            <button class="tab" data-mode="simplify">约分</button>
                            <button class="tab" data-mode="common">通分</button>
                            <button class="tab" data-mode="convert">分数转换</button>
                        </div>
                        
                        <!-- 分数运算模式 -->
                        <div id="arithmeticSection" class="fraction-section">
                            <div class="fraction-inputs">
                                <!-- 第一个分数 -->
                                <div class="fraction-input-group">
                                    <div class="fraction-input-title">第一个分数</div>
                                    <div class="fraction-row">
                                        <input type="number" id="num1" class="fraction-input numerator" placeholder="分子" value="1">
                                        <div class="fraction-line"></div>
                                        <input type="number" id="den1" class="fraction-input denominator" placeholder="分母" value="2">
                                    </div>
                                </div>
                                
                                <!-- 运算符选择 -->
                                <div class="operator-select">
                                    <select id="operator" class="operator-dropdown">
                                        <option value="+">+ (加)</option>
                                        <option value="-">- (减)</option>
                                        <option value="×">× (乘)</option>
                                        <option value="÷">÷ (除)</option>
                                    </select>
                                </div>
                                
                                <!-- 第二个分数 -->
                                <div class="fraction-input-group">
                                    <div class="fraction-input-title">第二个分数</div>
                                    <div class="fraction-row">
                                        <input type="number" id="num2" class="fraction-input numerator" placeholder="分子" value="1">
                                        <div class="fraction-line"></div>
                                        <input type="number" id="den2" class="fraction-input denominator" placeholder="分母" value="3">
                                    </div>
                                </div>
                                
                                <!-- 等号 -->
                                <div class="equals-sign">=</div>
                                
                                <!-- 结果显示 -->
                                <div class="fraction-result">
                                    <div class="fraction-input-title">计算结果</div>
                                    <div class="fraction-row">
                                        <div id="resultNum" class="fraction-result-numerator">5</div>
                                        <div class="fraction-line"></div>
                                        <div id="resultDen" class="fraction-result-denominator">6</div>
                                    </div>
                                    <div id="decimalResult" class="decimal-result">≈ 0.8333</div>
                                </div>
                            </div>
                            
                            <!-- 计算详情 -->
                            <div class="calculation-details">
                                <h4 class="details-title"><i class="fas fa-calculator"></i> 计算步骤</h4>
                                <div class="steps" id="arithmeticSteps">
                                    <div class="step">1/2 + 1/3</div>
                                    <div class="step">通分: 3/6 + 2/6</div>
                                    <div class="step">分子相加: 3 + 2 = 5</div>
                                    <div class="step">结果: 5/6</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 约分模式 -->
                        <div id="simplifySection" class="fraction-section" style="display: none;">
                            <div class="fraction-inputs">
                                <div class="fraction-input-group full-width">
                                    <div class="fraction-input-title">输入分数</div>
                                    <div class="fraction-row">
                                        <input type="number" id="simplifyNum" class="fraction-input numerator" placeholder="分子" value="12">
                                        <div class="fraction-line"></div>
                                        <input type="number" id="simplifyDen" class="fraction-input denominator" placeholder="分母" value="18">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 约分按钮 -->
                            <div class="simplify-actions">
                                <button class="btn btn-outline" id="simplifyBtn">
                                    <i class="fas fa-compress-alt"></i> 约分
                                </button>
                                <button class="btn btn-outline" id="findGcdBtn">
                                    <i class="fas fa-search"></i> 查找最大公约数
                                </button>
                            </div>
                            
                            <!-- 约分结果 -->
                            <div class="simplify-result">
                                <h4 class="details-title"><i class="fas fa-check-circle"></i> 约分结果</h4>
                                <div class="result-grid">
                                    <div class="result-item">
                                        <span class="result-label">原始分数</span>
                                        <span class="result-value" id="originalFraction">12/18</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">最大公约数</span>
                                        <span class="result-value" id="gcdValue">6</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">约分后分数</span>
                                        <span class="result-value" id="simplifiedFraction">2/3</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">小数形式</span>
                                        <span class="result-value" id="simplifiedDecimal">≈ 0.6667</span>
                                    </div>
                                </div>
                                
                                <!-- 约分步骤 -->
                                <div class="simplify-steps mt-4">
                                    <h5 class="steps-title">约分步骤</h5>
                                    <div class="steps" id="simplifySteps">
                                        <div class="step">1. 找出12和18的最大公约数: 6</div>
                                        <div class="step">2. 分子除以最大公约数: 12 ÷ 6 = 2</div>
                                        <div class="step">3. 分母除以最大公约数: 18 ÷ 6 = 3</div>
                                        <div class="step">4. 约分结果: 2/3</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 通分模式 -->
                        <div id="commonSection" class="fraction-section" style="display: none;">
                            <div class="fraction-inputs">
                                <!-- 第一个分数 -->
                                <div class="fraction-input-group">
                                    <div class="fraction-input-title">第一个分数</div>
                                    <div class="fraction-row">
                                        <input type="number" id="commonNum1" class="fraction-input numerator" placeholder="分子" value="1">
                                        <div class="fraction-line"></div>
                                        <input type="number" id="commonDen1" class="fraction-input denominator" placeholder="分母" value="2">
                                    </div>
                                </div>
                                
                                <!-- 第二个分数 -->
                                <div class="fraction-input-group">
                                    <div class="fraction-input-title">第二个分数</div>
                                    <div class="fraction-row">
                                        <input type="number" id="commonNum2" class="fraction-input numerator" placeholder="分子" value="1">
                                        <div class="fraction-line"></div>
                                        <input type="number" id="commonDen2" class="fraction-input denominator" placeholder="分母" value="3">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 通分按钮 -->
                            <button class="btn btn-outline btn-block" id="commonDenominatorBtn">
                                <i class="fas fa-balance-scale"></i> 计算公分母
                            </button>
                            
                            <!-- 通分结果 -->
                            <div class="common-result">
                                <h4 class="details-title"><i class="fas fa-exchange-alt"></i> 通分结果</h4>
                                <div class="result-grid">
                                    <div class="result-item">
                                        <span class="result-label">最小公倍数</span>
                                        <span class="result-value" id="lcmValue">6</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">第一个分数通分</span>
                                        <span class="result-value" id="commonFraction1">3/6</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">第二个分数通分</span>
                                        <span class="result-value" id="commonFraction2">2/6</span>
                                    </div>
                                </div>
                                
                                <!-- 通分步骤 -->
                                <div class="common-steps mt-4">
                                    <h5 class="steps-title">通分步骤</h5>
                                    <div class="steps" id="commonSteps">
                                        <div class="step">1. 找出分母2和3的最小公倍数: 6</div>
                                        <div class="step">2. 第一个分数: 1/2 = (1×3)/(2×3) = 3/6</div>
                                        <div class="step">3. 第二个分数: 1/3 = (1×2)/(3×2) = 2/6</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 分数转换模式 -->
                        <div id="convertSection" class="fraction-section" style="display: none;">
                            <div class="conversion-inputs">
                                <div class="input-group">
                                    <label class="input-label">输入数值</label>
                                    <input type="number" id="convertValue" class="input-field" placeholder="例如：0.75" value="0.75" step="any">
                                </div>
                                
                                <div class="conversion-type">
                                    <label class="input-label">转换类型</label>
                                    <div class="conversion-options">
                                        <label class="conversion-option">
                                            <input type="radio" name="conversionType" value="toFraction" checked>
                                            <span>小数转分数</span>
                                        </label>
                                        <label class="conversion-option">
                                            <input type="radio" name="conversionType" value="toDecimal">
                                            <span>分数转小数</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- 分数输入（仅当分数转小数时显示） -->
                                <div id="fractionToDecimalInput" style="display: none;">
                                    <div class="fraction-input-group">
                                        <div class="fraction-input-title">输入分数</div>
                                        <div class="fraction-row">
                                            <input type="number" id="convertNum" class="fraction-input numerator" placeholder="分子" value="3">
                                            <div class="fraction-line"></div>
                                            <input type="number" id="convertDen" class="fraction-input denominator" placeholder="分母" value="4">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 转换按钮 -->
                            <button class="btn btn-outline btn-block" id="convertBtn">
                                <i class="fas fa-sync-alt"></i> 转换
                            </button>
                            
                            <!-- 转换结果 -->
                            <div class="conversion-result">
                                <h4 class="details-title"><i class="fas fa-exchange-alt"></i> 转换结果</h4>
                                <div class="result-grid">
                                    <div class="result-item">
                                        <span class="result-label">输入值</span>
                                        <span class="result-value" id="inputValueDisplay">0.75</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">转换结果</span>
                                        <span class="result-value" id="conversionResult">3/4</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">小数形式</span>
                                        <span class="result-value" id="conversionDecimal">0.75</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">百分比</span>
                                        <span class="result-value" id="conversionPercent">75%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 计算按钮 -->
                        <button class="btn btn-primary btn-block calc-btn" id="calculateBtn">
                            <i class="fas fa-calculator"></i> 计算
                        </button>
                    </div>
                    
                    <!-- 分数基础知识 -->
                    <div class="fraction-basics mt-6">
                        <h3 class="section-title" style="font-size: 1.25rem; text-align: center; margin-bottom: 1rem;">
                            <i class="fas fa-book"></i> 分数基础知识
                        </h3>
                        <div class="basics-grid">
                            <div class="basic-item">
                                <div class="basic-icon" style="background: #3b82f6">
                                    <i class="fas fa-divide"></i>
                                </div>
                                <div class="basic-content">
                                    <h4>分数定义</h4>
                                    <p>分数表示一个整体被等分后的部分，由分子和分母组成。分子表示取了多少部分，分母表示整体被分成了多少等份。</p>
                                    <div class="basic-example">例：3/4 表示整体分成4份，取其中的3份</div>
                                </div>
                            </div>
                            <div class="basic-item">
                                <div class="basic-icon" style="background: #10b981">
                                    <i class="fas fa-compress-alt"></i>
                                </div>
                                <div class="basic-content">
                                    <h4>约分</h4>
                                    <p>约分是将分数的分子和分母同时除以它们的最大公约数，得到最简分数。最简分数不能再进行约分。</p>
                                    <div class="basic-example">例：8/12 约分为 2/3 (分子分母同除以4)</div>
                                </div>
                            </div>
                            <div class="basic-item">
                                <div class="basic-icon" style="background: #8b5cf6">
                                    <i class="fas fa-balance-scale"></i>
                                </div>
                                <div class="basic-content">
                                    <h4>通分</h4>
                                    <p>通分是将两个或多个分数的分母变为相同的数，通常取分母的最小公倍数。通分后可以进行分数的加减运算。</p>
                                    <div class="basic-example">例：1/2 和 1/3 通分为 3/6 和 2/6</div>
                                </div>
                            </div>
                            <div class="basic-item">
                                <div class="basic-icon" style="background: #f59e0b">
                                    <i class="fas fa-calculator"></i>
                                </div>
                                <div class="basic-content">
                                    <h4>分数运算</h4>
                                    <p>分数加减需要通分，分数乘除直接运算。分数乘法：分子乘分子，分母乘分母。分数除法：乘以倒数。</p>
                                    <div class="basic-example">例：1/2 × 2/3 = 2/6 = 1/3</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 使用说明 -->
                    <div class="alert alert-info mt-6">
                        <div class="flex items-center">
                            <i class="fas fa-lightbulb mr-3"></i>
                            <div>
                                <strong>分数计算说明：</strong> 
                                <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
                                    <li><strong>分数运算</strong>：进行分数的加减乘除运算，显示详细计算步骤</li>
                                    <li><strong>约分</strong>：将分数化为最简形式，查找最大公约数</li>
                                    <li><strong>通分</strong>：将不同分母的分数转换为相同分母，便于比较和运算</li>
                                    <li><strong>分数转换</strong>：小数与分数之间的相互转换</li>
                                    <li><strong>输入说明</strong>：输入整数或小数，支持负数分数</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="app-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-section">
                    <a href="../../index.html" class="footer-logo">
                        <i class="fas fa-calculator"></i>
                        <span>生活计算宝典</span>
                    </a>
                    <p class="footer-description">
                        一站式离线计算工具集合，为您的生活带来便利。
                    </p>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-heading">学习工具</h4>
                    <a href="unit-convert.html" class="footer-link">单位换算器</a>
                    <a href="percentage.html" class="footer-link">百分比计算器</a>
                    <a href="average.html" class="footer-link">平均数计算器</a>
                    <a href="equation.html" class="footer-link">方程求解</a>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-heading">快速链接</h4>
                    <a href="../../pages/study.html" class="footer-link">返回学习工具</a>
                    <a href="../../pages/tools.html" class="footer-link">所有工具</a>
                    <a href="https://github.com/laddzhao/life-calculators" target="_blank" class="footer-link">GitHub项目</a>
                    <a href="../../404.html" class="footer-link">404页面</a>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-heading">其他工具</h4>
                    <a href="../health/bmi.html" class="footer-link">BMI计算</a>
                    <a href="../finance/compound.html" class="footer-link">复利计算器</a>
                    <a href="../shopping/discount.html" class="footer-link">折扣计算器</a>
                    <a href="../professional/tax.html" class="footer-link">税费计算</a>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2026 生活计算宝典 · 分数计算器</p>
            </div>
        </div>
    </footer>

    <!-- 移动端底部导航 -->
    <nav class="mobile-bottom-nav">
        <a href="../../index.html" class="nav-item">
            <i class="fas fa-home nav-icon"></i>
            <span class="nav-label">首页</span>
        </a>
        <a href="../../pages/study.html" class="nav-item active">
            <i class="fas fa-graduation-cap nav-icon"></i>
            <span class="nav-label">学习</span>
        </a>
        <a href="../../pages/tools.html" class="nav-item">
            <i class="fas fa-th nav-icon"></i>
            <span class="nav-label">全部</span>
        </a>
        <a href="#" class="nav-item" id="mobileMenuBtn">
            <i class="fas fa-ellipsis-h nav-icon"></i>
            <span class="nav-label">更多</span>
        </a>
    </nav>

    <script>
        // 当前计算模式
        let currentMode = 'arithmetic';
        
        // 最大公约数函数
        function gcd(a, b) {
            a = Math.abs(a);
            b = Math.abs(b);
            while (b) {
                const temp = b;
                b = a % b;
                a = temp;
            }
            return a;
        }
        
        // 最小公倍数函数
        function lcm(a, b) {
            return Math.abs(a * b) / gcd(a, b);
        }
        
        // 小数转分数函数
        function decimalToFraction(decimal) {
            const tolerance = 1.0E-6;
            let numerator = 1;
            let denominator = 1;
            let fraction = numerator / denominator;
            
            while (Math.abs(fraction - decimal) > tolerance) {
                if (fraction < decimal) {
                    numerator++;
                } else {
                    denominator++;
                    numerator = Math.round(decimal * denominator);
                }
                fraction = numerator / denominator;
                
                // 防止无限循环
                if (denominator > 10000) break;
            }
            
            // 约分
            const common = gcd(numerator, denominator);
            return {
                numerator: numerator / common,
                denominator: denominator / common
            };
        }
        
        // 分数运算
        function calculateFractionOperation() {
            const num1 = parseInt(document.getElementById('num1').value) || 0;
            const den1 = parseInt(document.getElementById('den1').value) || 1;
            const num2 = parseInt(document.getElementById('num2').value) || 0;
            const den2 = parseInt(document.getElementById('den2').value) || 1;
            const operator = document.getElementById('operator').value;
            
            let resultNum, resultDen;
            let steps = [];
            
            // 检查分母是否为0
            if (den1 === 0 || den2 === 0) {
                document.getElementById('resultNum').textContent = "无效";
                document.getElementById('resultDen').textContent = "分母不能为0";
                document.getElementById('decimalResult').textContent = "";
                return;
            }
            
            switch (operator) {
                case '+':
                    // 加法：通分后分子相加
                    const lcmVal = lcm(den1, den2);
                    const newNum1 = num1 * (lcmVal / den1);
                    const newNum2 = num2 * (lcmVal / den2);
                    resultNum = newNum1 + newNum2;
                    resultDen = lcmVal;
                    
                    steps.push(`${num1}/${den1} + ${num2}/${den2}`);
                    steps.push(`通分: ${newNum1}/${lcmVal} + ${newNum2}/${lcmVal}`);
                    steps.push(`分子相加: ${newNum1} + ${newNum2} = ${resultNum}`);
                    break;
                    
                case '-':
                    // 减法：通分后分子相减
                    const lcmVal2 = lcm(den1, den2);
                    const newNum1Sub = num1 * (lcmVal2 / den1);
                    const newNum2Sub = num2 * (lcmVal2 / den2);
                    resultNum = newNum1Sub - newNum2Sub;
                    resultDen = lcmVal2;
                    
                    steps.push(`${num1}/${den1} - ${num2}/${den2}`);
                    steps.push(`通分: ${newNum1Sub}/${lcmVal2} - ${newNum2Sub}/${lcmVal2}`);
                    steps.push(`分子相减: ${newNum1Sub} - ${newNum2Sub} = ${resultNum}`);
                    break;
                    
                case '×':
                    // 乘法：分子乘分子，分母乘分母
                    resultNum = num1 * num2;
                    resultDen = den1 * den2;
                    
                    steps.push(`${num1}/${den1} × ${num2}/${den2}`);
                    steps.push(`分子相乘: ${num1} × ${num2} = ${resultNum}`);
                    steps.push(`分母相乘: ${den1} × ${den2} = ${resultDen}`);
                    break;
                    
                case '÷':
                    // 除法：乘以倒数
                    if (num2 === 0) {
                        document.getElementById('resultNum').textContent = "无效";
                        document.getElementById('resultDen').textContent = "除数不能为0";
                        document.getElementById('decimalResult').textContent = "";
                        return;
                    }
                    
                    resultNum = num1 * den2;
                    resultDen = den1 * num2;
                    
                    steps.push(`${num1}/${den1} ÷ ${num2}/${den2}`);
                    steps.push(`转换为乘法: ${num1}/${den1} × ${den2}/${num2}`);
                    steps.push(`分子相乘: ${num1} × ${den2} = ${resultNum}`);
                    steps.push(`分母相乘: ${den1} × ${num2} = ${resultDen}`);
                    break;
            }
            
            // 约分结果
            const common = gcd(resultNum, resultDen);
            const simplifiedNum = resultNum / common;
            const simplifiedDen = resultDen / common;
            
            // 显示结果
            document.getElementById('resultNum').textContent = simplifiedNum;
            document.getElementById('resultDen').textContent = simplifiedDen;
            
            // 计算小数形式
            const decimalValue = resultNum / resultDen;
            document.getElementById('decimalResult').textContent = `≈ ${decimalValue.toFixed(4)}`;
            
            // 显示计算步骤
            steps.push(`约分: ${resultNum}/${resultDen} = ${simplifiedNum}/${simplifiedDen}`);
            
            const stepsContainer = document.getElementById('arithmeticSteps');
            stepsContainer.innerHTML = '';
            steps.forEach((step, index) => {
                const stepDiv = document.createElement('div');
                stepDiv.className = 'step';
                stepDiv.textContent = `${index + 1}. ${step}`;
                stepsContainer.appendChild(stepDiv);
            });
        }
        
        // 约分计算
        function simplifyFraction() {
            const numerator = parseInt(document.getElementById('simplifyNum').value) || 0;
            const denominator = parseInt(document.getElementById('simplifyDen').value) || 1;
            
            if (denominator === 0) {
                alert('分母不能为0');
                return;
            }
            
            // 计算最大公约数
            const common = gcd(numerator, denominator);
            const simplifiedNum = numerator / common;
            const simplifiedDen = denominator / common;
            
            // 显示结果
            document.getElementById('originalFraction').textContent = `${numerator}/${denominator}`;
            document.getElementById('gcdValue').textContent = common;
            document.getElementById('simplifiedFraction').textContent = `${simplifiedNum}/${simplifiedDen}`;
            
            // 计算小数形式
            const decimalValue = numerator / denominator;
            document.getElementById('simplifiedDecimal').textContent = `≈ ${decimalValue.toFixed(4)}`;
            
            // 显示计算步骤
            const steps = [
                `找出${numerator}和${denominator}的最大公约数: ${common}`,
                `分子除以最大公约数: ${numerator} ÷ ${common} = ${simplifiedNum}`,
                `分母除以最大公约数: ${denominator} ÷ ${common} = ${simplifiedDen}`,
                `约分结果: ${simplifiedNum}/${simplifiedDen}`
            ];
            
            const stepsContainer = document.getElementById('simplifySteps');
            stepsContainer.innerHTML = '';
            steps.forEach((step, index) => {
                const stepDiv = document.createElement('div');
                stepDiv.className = 'step';
                stepDiv.textContent = `${index + 1}. ${step}`;
                stepsContainer.appendChild(stepDiv);
            });
        }
        
        // 通分计算
        function calculateCommonDenominator() {
            const num1 = parseInt(document.getElementById('commonNum1').value) || 0;
            const den1 = parseInt(document.getElementById('commonDen1').value) || 1;
            const num2 = parseInt(document.getElementById('commonNum2').value) || 0;
            const den2 = parseInt(document.getElementById('commonDen2').value) || 1;
            
            if (den1 === 0 || den2 === 0) {
                alert('分母不能为0');
                return;
            }
            
            // 计算最小公倍数
            const lcmVal = lcm(den1, den2);
            
            // 计算通分后的分数
            const newNum1 = num1 * (lcmVal / den1);
            const newNum2 = num2 * (lcmVal / den2);
            
            // 显示结果
            document.getElementById('lcmValue').textContent = lcmVal;
            document.getElementById('commonFraction1').textContent = `${newNum1}/${lcmVal}`;
            document.getElementById('commonFraction2').textContent = `${newNum2}/${lcmVal}`;
            
            // 显示计算步骤
            const steps = [
                `找出分母${den1}和${den2}的最小公倍数: ${lcmVal}`,
                `第一个分数: ${num1}/${den1} = (${num1}×${lcmVal/den1})/(${den1}×${lcmVal/den1}) = ${newNum1}/${lcmVal}`,
                `第二个分数: ${num2}/${den2} = (${num2}×${lcmVal/den2})/(${den2}×${lcmVal/den2}) = ${newNum2}/${lcmVal}`
            ];
            
            const stepsContainer = document.getElementById('commonSteps');
            stepsContainer.innerHTML = '';
            steps.forEach((step, index) => {
                const stepDiv = document.createElement('div');
                stepDiv.className = 'step';
                stepDiv.textContent = `${index + 1}. ${step}`;
                stepsContainer.appendChild(stepDiv);
            });
        }
        
        // 分数转换
        function convertFraction() {
            const conversionType = document.querySelector('input[name="conversionType"]:checked').value;
            
            if (conversionType === 'toFraction') {
                // 小数转分数
                const decimalValue = parseFloat(document.getElementById('convertValue').value) || 0;
                
                // 检查输入是否有效
                if (isNaN(decimalValue)) {
                    alert('请输入有效的数字');
                    return;
                }
                
                const fraction = decimalToFraction(decimalValue);
                
                // 显示结果
                document.getElementById('inputValueDisplay').textContent = decimalValue;
                document.getElementById('conversionResult').textContent = `${fraction.numerator}/${fraction.denominator}`;
                document.getElementById('conversionDecimal').textContent = decimalValue.toFixed(4);
                document.getElementById('conversionPercent').textContent = `${(decimalValue * 100).toFixed(2)}%`;
            } else {
                // 分数转小数
                const numerator = parseInt(document.getElementById('convertNum').value) || 0;
                const denominator = parseInt(document.getElementById('convertDen').value) || 1;
                
                if (denominator === 0) {
                    alert('分母不能为0');
                    return;
                }
                
                const decimalValue = numerator / denominator;
                
                // 显示结果
                document.getElementById('inputValueDisplay').textContent = `${numerator}/${denominator}`;
                document.getElementById('conversionResult').textContent = decimalValue.toFixed(4);
                document.getElementById('conversionDecimal').textContent = decimalValue.toFixed(4);
                document.getElementById('conversionPercent').textContent = `${(decimalValue * 100).toFixed(2)}%`;
            }
        }
        
        // 计算模式切换
        document.querySelectorAll('#fractionModeTabs .tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // 移除所有active类
                document.querySelectorAll('#fractionModeTabs .tab').forEach(t => {
                    t.classList.remove('active');
                });
                
                // 添加active类到当前标签
                this.classList.add('active');
                
                const mode = this.dataset.mode;
                currentMode = mode;
                
                // 显示对应的内容区域
                document.querySelectorAll('.fraction-section').forEach(section => {
                    section.style.display = 'none';
                });
                document.getElementById(`${mode}Section`).style.display = 'block';
                
                // 根据模式重新计算
                switch(mode) {
                    case 'arithmetic':
                        calculateFractionOperation();
                        break;
                    case 'simplify':
                        simplifyFraction();
                        break;
                    case 'common':
                        calculateCommonDenominator();
                        break;
                    case 'convert':
                        convertFraction();
                        break;
                }
            });
        });
        
        // 转换类型切换
        document.querySelectorAll('input[name="conversionType"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const type = this.value;
                const fractionInput = document.getElementById('fractionToDecimalInput');
                
                if (type === 'toDecimal') {
                    fractionInput.style.display = 'block';
                } else {
                    fractionInput.style.display = 'none';
                }
                
                convertFraction();
            });
        });
        
        // 绑定按钮事件
        function setupEventListeners() {
            // 分数运算输入变化
            document.querySelectorAll('#arithmeticSection input, #arithmeticSection select').forEach(element => {
                element.addEventListener('input', calculateFractionOperation);
            });
            
            // 约分按钮
            document.getElementById('simplifyBtn').addEventListener('click', simplifyFraction);
            document.getElementById('findGcdBtn').addEventListener('click', simplifyFraction);
            
            // 约分输入变化
            document.querySelectorAll('#simplifySection input').forEach(element => {
                element.addEventListener('input', simplifyFraction);
            });
            
            // 通分按钮
            document.getElementById('commonDenominatorBtn').addEventListener('click', calculateCommonDenominator);
            
            // 通分输入变化
            document.querySelectorAll('#commonSection input').forEach(element => {
                element.addEventListener('input', calculateCommonDenominator);
            });
            
            // 转换按钮
            document.getElementById('convertBtn').addEventListener('click', convertFraction);
            
            // 转换输入变化
            document.querySelectorAll('#convertSection input').forEach(element => {
                element.addEventListener('input', convertFraction);
            });
            
            // 主计算按钮
            document.getElementById('calculateBtn').addEventListener('click', function() {
                switch(currentMode) {
                    case 'arithmetic':
                        calculateFractionOperation();
                        break;
                    case 'simplify':
                        simplifyFraction();
                        break;
                    case 'common':
                        calculateCommonDenominator();
                        break;
                    case 'convert':
                        convertFraction();
                        break;
                }
            });
        }
        
        // 主题切换
        function initTheme() {
            const themeBtn = document.querySelector('.theme-btn');
            
            // 检查本地存储的主题设置
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
            
            // 切换主题函数
            function toggleTheme() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                
                // 更新图标
                if (themeBtn) {
                    const icon = themeBtn.querySelector('i');
                    icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
                }
            }
            
            // 添加事件监听
            if (themeBtn) themeBtn.addEventListener('click', toggleTheme);
        }
        
        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            setupEventListeners();
            
            // 页面加载时自动计算一次
            calculateFractionOperation();
            simplifyFraction();
            calculateCommonDenominator();
            convertFraction();
            
            // 移动端菜单
            const menuBtn = document.getElementById('mobileMenuBtn');
            if (menuBtn) {
                menuBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    alert('移动端菜单功能需要完整的菜单HTML结构');
                });
            }
        });
    </script>
    
    <style>
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-light);
            margin-bottom: 1.5rem;
            overflow-x: auto;
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            color: var(--text-secondary);
            text-decoration: none;
            border: none;
            background: none;
            border-bottom: 2px solid transparent;
            white-space: nowrap;
            cursor: pointer;
            transition: all var(--transition);
        }
        
        .tab:hover {
            color: var(--primary);
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .fraction-section {
            margin-bottom: 1.5rem;
        }
        
        .fraction-inputs {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .fraction-input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .fraction-input-group.full-width {
            width: 100%;
        }
        
        .fraction-input-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }
        
        .fraction-row {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            min-height: 4rem;
        }
        
        .fraction-input {
            width: 4rem;
            text-align: center;
            padding: 0.5rem;
            border: 1px solid var(--border-light);
            border-radius: var(--radius);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .fraction-input.numerator {
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
            border-bottom: none;
        }
        
        .fraction-input.denominator {
            border-top-left-radius: 0;
            border-top-right-radius: 0;
        }
        
        .fraction-line {
            width: 100%;
            height: 2px;
            background: var(--text-primary);
            margin: 0.25rem 0;
        }
        
        .operator-select {
            margin: 0 1rem;
        }
        
        .operator-dropdown {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-light);
            border-radius: var(--radius);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .equals-sign {
            font-size: 2rem;
            font-weight: 600;
            color: var(--primary);
            margin: 0 1rem;
        }
        
        .fraction-result {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .fraction-result-numerator,
        .fraction-result-denominator {
            width: 4rem;
            text-align: center;
            padding: 0.5rem;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .fraction-result-numerator {
            border-bottom: 2px solid var(--primary);
        }
        
        .decimal-result {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .calculation-details {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 1rem;
            margin-top: 1.5rem;
            border: 1px solid var(--border-light);
        }
        
        .details-title {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .steps {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .step {
            padding: 0.5rem;
            background: var(--bg-primary);
            border-radius: var(--radius);
            border-left: 3px solid var(--primary);
            font-size: 0.9rem;
        }
        
        .simplify-actions {
            display: flex;
            gap: 0.5rem;
            margin: 1rem 0;
            justify-content: center;
        }
        
        .simplify-result,
        .common-result,
        .conversion-result {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 1rem;
            margin-top: 1rem;
            border: 1px solid var(--border-light);
        }
        
        .steps-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }
        
        .conversion-inputs {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .conversion-type {
            margin-bottom: 1rem;
        }
        
        .conversion-options {
            display: flex;
            gap: 1rem;
            margin-top: 0.5rem;
        }
        
        .conversion-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: var(--radius);
            transition: background var(--transition);
        }
        
        .conversion-option:hover {
            background: var(--bg-secondary);
        }
        
        .fraction-basics {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            border: 1px solid var(--border-light);
        }
        
        .basics-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        @media (min-width: 768px) {
            .basics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (min-width: 1024px) {
            .basics-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        .basic-item {
            display: flex;
            flex-direction: column;
            padding: 1rem;
            background: var(--bg-primary);
            border-radius: var(--radius);
            border: 1px solid var(--border-light);
        }
        
        .basic-icon {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
            margin-bottom: 0.75rem;
        }
        
        .basic-content {
            flex: 1;
        }
        
        .basic-content h4 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }
        
        .basic-content p {
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.4;
            margin-bottom: 0.5rem;
        }
        
        .basic-example {
            font-size: 0.75rem;
            color: var(--primary);
            font-family: 'Courier New', monospace;
            padding: 0.5rem;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
        }
        
        @media (max-width: 640px) {
            .tab {
                padding: 0.5rem 1rem;
                font-size: 0.875rem;
            }
            
            .fraction-inputs {
                flex-direction: column;
                align-items: center;
            }
            
            .operator-select {
                margin: 1rem 0;
            }
            
            .equals-sign {
                margin: 1rem 0;
            }
            
            .conversion-options {
                flex-direction: column;
            }
            
            .basics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</body>
</html>