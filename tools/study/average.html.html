<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>平均数计算器 - 生活计算宝典</title>
    <link rel="stylesheet" href="../../style.css">
    <link rel="stylesheet" href="../../layout.css">
    <link rel="stylesheet" href="../../components.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="../../favicon.ico" type="image/x-icon">
</head>
<body class="app">
    <header class="app-header">
        <div class="container">
            <nav class="navbar">
                <div class="navbar-mobile">
                    <a href="../../pages/study.html" class="navbar-back">
                        <i class="fas fa-arrow-left"></i>
                    </a>
                    <div class="navbar-title">平均数计算器</div>
                    <div></div>
                </div>
                
                <div class="navbar-desktop">
                    <a href="../../index.html" class="logo">
                        <i class="fas fa-calculator"></i>
                        <span class="logo-text">生活计算宝典</span>
                    </a>
                    <div class="nav-links">
                        <a href="../../index.html" class="nav-link">首页</a>
                        <a href="../../pages/study.html" class="nav-link active">学习工具</a>
                        <a href="../../pages/tools.html" class="nav-link">所有工具</a>
                    </div>
                    <div class="theme-toggle">
                        <button class="theme-btn" aria-label="切换主题">
                            <i class="fas fa-moon"></i>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="app-main">
        <section class="section">
            <div class="container">
                <!-- 面包屑导航 -->
                <nav class="breadcrumb">
                    <a href="../../index.html" class="breadcrumb-link">首页</a>
                    <span class="breadcrumb-divider"><i class="fas fa-chevron-right"></i></span>
                    <a href="../../pages/study.html" class="breadcrumb-link">学习工具</a>
                    <span class="breadcrumb-divider"><i class="fas fa-chevron-right"></i></span>
                    <span class="breadcrumb-current">平均数计算器</span>
                </nav>
                
                <!-- 计算器容器 -->
                <div class="calculator-container">
                    <div class="calculator-card">
                        <div class="calculator-header">
                            <h1 class="calculator-title">平均数计算器</h1>
                            <p class="calculator-description">
                                专业的平均数计算工具，支持算术平均数、中位数和众数计算。
                            </p>
                        </div>
                        
                        <!-- 数据输入区域 -->
                        <div class="data-input-section">
                            <div class="input-group">
                                <label class="input-label">输入数据（用逗号或空格分隔）</label>
                                <textarea id="dataInput" class="input-field textarea" rows="3" placeholder="例如：85, 90, 78, 92, 88">85, 90, 78, 92, 88</textarea>
                            </div>
                            
                            <div class="input-actions">
                                <button class="btn btn-outline" id="clearDataBtn">
                                    <i class="fas fa-trash"></i> 清空数据
                                </button>
                                <button class="btn btn-outline" id="exampleDataBtn">
                                    <i class="fas fa-magic"></i> 示例数据
                                </button>
                            </div>
                            
                            <div class="data-summary">
                                <div class="summary-item">
                                    <span class="summary-label">数据数量</span>
                                    <span class="summary-value" id="dataCount">5</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">数据范围</span>
                                    <span class="summary-value" id="dataRange">78 - 92</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">数据预览</span>
                                    <span class="summary-value" id="dataPreview">85, 90, 78, 92, 88</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 计算类型选择 -->
                        <div class="tabs" id="calculationTypeTabs">
                            <button class="tab active" data-type="mean">算术平均数</button>
                            <button class="tab" data-type="median">中位数</button>
                            <button class="tab" data-type="mode">众数</button>
                        </div>
                        
                        <!-- 算术平均数计算 -->
                        <div id="meanSection" class="calculation-section">
                            <div class="calculation-formula">
                                <div class="formula-title">算术平均数公式</div>
                                <div class="formula">平均数 = (数据总和) ÷ (数据个数)</div>
                                <div class="formula">μ = (∑xᵢ) ÷ n</div>
                            </div>
                            
                            <!-- 计算结果 -->
                            <div class="result-display" id="meanResult">
                                <h3 class="result-title"><i class="fas fa-calculator"></i> 算术平均数计算结果</h3>
                                <div class="result-grid">
                                    <div class="result-item">
                                        <span class="result-label">算术平均数</span>
                                        <span class="result-value" id="meanValue">86.6</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">数据总和</span>
                                        <span class="result-value" id="sumValue">433</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">数据个数</span>
                                        <span class="result-value" id="countValue">5</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">计算公式</span>
                                        <span class="result-value" id="meanFormula">(85+90+78+92+88) ÷ 5 = 86.6</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 中位数计算 -->
                        <div id="medianSection" class="calculation-section" style="display: none;">
                            <div class="calculation-formula">
                                <div class="formula-title">中位数公式</div>
                                <div class="formula">奇数个数据：中间位置的数值</div>
                                <div class="formula">偶数个数据：中间两个数值的平均值</div>
                            </div>
                            
                            <!-- 计算结果 -->
                            <div class="result-display" id="medianResult">
                                <h3 class="result-title"><i class="fas fa-sort-numeric-up"></i> 中位数计算结果</h3>
                                <div class="result-grid">
                                    <div class="result-item">
                                        <span class="result-label">中位数</span>
                                        <span class="result-value" id="medianValue">88</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">排序后数据</span>
                                        <span class="result-value" id="sortedData">78, 85, 88, 90, 92</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">中间位置</span>
                                        <span class="result-value" id="medianPosition">第3位</span>
                                    </div>
                                    <div class="result-label full-width">
                                        <span>中位数说明</span>
                                        <div class="result-value" id="medianExplanation">数据个数为奇数，取排序后第3位的数值88作为中位数</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 众数计算 -->
                        <div id="modeSection" class="calculation-section" style="display: none;">
                            <div class="calculation-formula">
                                <div class="formula-title">众数公式</div>
                                <div class="formula">众数 = 数据集中出现频率最高的数值</div>
                                <div class="formula">可能没有众数、有一个众数或多个众数</div>
                            </div>
                            
                            <!-- 计算结果 -->
                            <div class="result-display" id="modeResult">
                                <h3 class="result-title"><i class="fas fa-chart-bar"></i> 众数计算结果</h3>
                                <div class="result-grid">
                                    <div class="result-item">
                                        <span class="result-label">众数</span>
                                        <span class="result-value" id="modeValue">无</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">最高频次</span>
                                        <span class="result-value" id="maxFrequency">1</span>
                                    </div>
                                    <div class="result-item">
                                        <span class="result-label">数据分布</span>
                                        <span class="result-value" id="dataDistribution">所有数值出现1次</span>
                                    </div>
                                </div>
                                
                                <!-- 频率分布表 -->
                                <div class="frequency-table mt-4">
                                    <h4 class="frequency-title">频率分布表</h4>
                                    <div class="table-responsive">
                                        <table class="data-table" id="frequencyTable">
                                            <thead>
                                                <tr>
                                                    <th>数值</th>
                                                    <th>出现次数</th>
                                                    <th>频率</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- 频率数据将动态生成 -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 计算按钮 -->
                        <button class="btn btn-primary btn-block calc-btn" id="calculateBtn">
                            <i class="fas fa-calculator"></i> 计算
                        </button>
                        
                        <!-- 数据可视化 -->
                        <div class="data-visualization mt-6" id="visualizationSection">
                            <h3 class="result-title"><i class="fas fa-chart-bar"></i> 数据分布图</h3>
                            <div class="visualization-container">
                                <div class="chart-container" id="chartContainer">
                                    <!-- 图表将动态生成 -->
                                    <div class="simple-chart">
                                        <div class="chart-title">数据分布图</div>
                                        <div class="chart-bars" id="chartBars">
                                            <!-- 柱状图将动态生成 -->
                                        </div>
                                        <div class="chart-axis">
                                            <div class="axis-label">数值</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="chart-legend" id="chartLegend">
                                    <!-- 图例将动态生成 -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 平均数类型说明 -->
                    <div class="average-types mt-6">
                        <h3 class="section-title" style="font-size: 1.25rem; text-align: center; margin-bottom: 1rem;">
                            <i class="fas fa-info-circle"></i> 平均数类型说明
                        </h3>
                        <div class="types-grid">
                            <div class="type-item">
                                <div class="type-icon" style="background: #3b82f6">
                                    <i class="fas fa-calculator"></i>
                                </div>
                                <div class="type-content">
                                    <h4>算术平均数</h4>
                                    <p>所有数值的总和除以数值的个数。最常用的平均数类型，适用于数据分布均匀的情况。</p>
                                    <div class="type-example">例：85, 90, 78 → (85+90+78)÷3 = 84.33</div>
                                </div>
                            </div>
                            <div class="type-item">
                                <div class="type-icon" style="background: #10b981">
                                    <i class="fas fa-sort-numeric-up"></i>
                                </div>
                                <div class="type-content">
                                    <h4>中位数</h4>
                                    <p>将数据按大小排序后位于中间位置的数值。不受极端值影响，适用于数据有异常值的情况。</p>
                                    <div class="type-example">例：85, 90, 78, 200 → 排序后：78, 85, 90, 200 → 中位数：87.5</div>
                                </div>
                            </div>
                            <div class="type-item">
                                <div class="type-icon" style="background: #8b5cf6">
                                    <i class="fas fa-chart-bar"></i>
                                </div>
                                <div class="type-content">
                                    <h4>众数</h4>
                                    <p>数据集中出现频率最高的数值。适用于分类数据或寻找最常见的数值。</p>
                                    <div class="type-example">例：85, 90, 85, 78, 92 → 众数：85（出现2次）</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 使用说明 -->
                    <div class="alert alert-info mt-6">
                        <div class="flex items-center">
                            <i class="fas fa-lightbulb mr-3"></i>
                            <div>
                                <strong>使用说明：</strong> 
                                <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
                                    <li><strong>数据输入</strong>：输入数字，用逗号、空格或换行分隔</li>
                                    <li><strong>算术平均数</strong>：计算所有数值的平均值</li>
                                    <li><strong>中位数</strong>：计算排序后位于中间位置的数值</li>
                                    <li><strong>众数</strong>：计算出现频率最高的数值</li>
                                    <li><strong>数据可视化</strong>：查看数据的柱状图分布</li>
                                    <li><strong>示例数据</strong>：点击"示例数据"按钮使用预设数据</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="app-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-section">
                    <a href="../../index.html" class="footer-logo">
                        <i class="fas fa-calculator"></i>
                        <span>生活计算宝典</span>
                    </a>
                    <p class="footer-description">
                        一站式离线计算工具集合，为您的生活带来便利。
                    </p>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-heading">学习工具</h4>
                    <a href="unit-convert.html" class="footer-link">单位换算器</a>
                    <a href="percentage.html" class="footer-link">百分比计算器</a>
                    <a href="fraction.html" class="footer-link">分数计算器</a>
                    <a href="equation.html" class="footer-link">方程求解</a>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-heading">快速链接</h4>
                    <a href="../../pages/study.html" class="footer-link">返回学习工具</a>
                    <a href="../../pages/tools.html" class="footer-link">所有工具</a>
                    <a href="https://github.com/laddzhao/life-calculators" target="_blank" class="footer-link">GitHub项目</a>
                    <a href="../../404.html" class="footer-link">404页面</a>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-heading">其他工具</h4>
                    <a href="../health/bmi.html" class="footer-link">BMI计算</a>
                    <a href="../finance/compound.html" class="footer-link">复利计算器</a>
                    <a href="../shopping/discount.html" class="footer-link">折扣计算器</a>
                    <a href="../professional/tax.html" class="footer-link">税费计算</a>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2026 生活计算宝典 · 平均数计算器</p>
            </div>
        </div>
    </footer>

    <!-- 移动端底部导航 -->
    <nav class="mobile-bottom-nav">
        <a href="../../index.html" class="nav-item">
            <i class="fas fa-home nav-icon"></i>
            <span class="nav-label">首页</span>
        </a>
        <a href="../../pages/study.html" class="nav-item active">
            <i class="fas fa-graduation-cap nav-icon"></i>
            <span class="nav-label">学习</span>
        </a>
        <a href="../../pages/tools.html" class="nav-item">
            <i class="fas fa-th nav-icon"></i>
                            <span class="nav-label">全部</span>
                        </a>
                        <a href="#" class="nav-item" id="mobileMenuBtn">
                            <i class="fas fa-ellipsis-h nav-icon"></i>
                            <span class="nav-label">更多</span>
                        </a>
                    </nav>
    
                    <script>
                        // 当前计算类型
                        let currentType = 'mean';
                        
                        // 示例数据
                        const exampleDatasets = {
                            examScores: [85, 90, 78, 92, 88, 95, 82, 87, 91, 84],
                            productPrices: [15.99, 12.50, 18.75, 12.50, 20.00, 15.99, 22.50, 15.99],
                            temperatures: [22.5, 24.0, 21.0, 23.5, 25.0, 22.5, 20.5, 24.0, 22.5],
                            ages: [25, 32, 28, 25, 30, 35, 28, 40, 28, 32]
                        };
                        
                        // 解析输入数据
                        function parseInputData(input) {
                            // 替换中文逗号为英文逗号，分割数据
                            const cleanedInput = input.replace(/，/g, ',').replace(/\s+/g, ' ');
                            const parts = cleanedInput.split(/[,，\s]+/).filter(part => part !== '');
                            
                            // 转换为数字数组
                            const numbers = parts.map(part => {
                                const num = parseFloat(part);
                                return isNaN(num) ? null : num;
                            }).filter(num => num !== null);
                            
                            return numbers;
                        }
                        
                        // 计算类型切换
                        document.querySelectorAll('#calculationTypeTabs .tab').forEach(tab => {
                            tab.addEventListener('click', function() {
                                // 移除所有active类
                                document.querySelectorAll('#calculationTypeTabs .tab').forEach(t => {
                                    t.classList.remove('active');
                                });
                                
                                // 添加active类到当前标签
                                this.classList.add('active');
                                
                                const type = this.dataset.type;
                                currentType = type;
                                
                                // 显示对应的内容区域
                                document.querySelectorAll('.calculation-section').forEach(section => {
                                    section.style.display = 'none';
                                });
                                document.getElementById(`${type}Section`).style.display = 'block';
                                
                                // 重新计算
                                calculateStatistics();
                            });
                        });
                        
                        // 清空数据
                        document.getElementById('clearDataBtn').addEventListener('click', function() {
                            document.getElementById('dataInput').value = '';
                            updateDataSummary([]);
                            clearResults();
                        });
                        
                        // 示例数据
                        document.getElementById('exampleDataBtn').addEventListener('click', function() {
                            const datasets = Object.values(exampleDatasets);
                            const randomDataset = datasets[Math.floor(Math.random() * datasets.length)];
                            document.getElementById('dataInput').value = randomDataset.join(', ');
                            calculateStatistics();
                        });
                        
                        // 更新数据摘要
                        function updateDataSummary(data) {
                            const count = data.length;
                            document.getElementById('dataCount').textContent = count;
                            
                            if (count === 0) {
                                document.getElementById('dataRange').textContent = '无数据';
                                document.getElementById('dataPreview').textContent = '无数据';
                                return;
                            }
                            
                            const sorted = [...data].sort((a, b) => a - b);
                            const min = sorted[0];
                            const max = sorted[sorted.length - 1];
                            document.getElementById('dataRange').textContent = `${min} - ${max}`;
                            
                            // 预览前5个数据
                            const preview = data.slice(0, 5).join(', ');
                            document.getElementById('dataPreview').textContent = preview + (count > 5 ? '...' : '');
                        }
                        
                        // 清空计算结果
                        function clearResults() {
                            document.getElementById('meanValue').textContent = '0';
                            document.getElementById('sumValue').textContent = '0';
                            document.getElementById('countValue').textContent = '0';
                            document.getElementById('meanFormula').textContent = '无数据';
                            
                            document.getElementById('medianValue').textContent = '0';
                            document.getElementById('sortedData').textContent = '无数据';
                            document.getElementById('medianPosition').textContent = '无数据';
                            document.getElementById('medianExplanation').textContent = '无数据';
                            
                            document.getElementById('modeValue').textContent = '无';
                            document.getElementById('maxFrequency').textContent = '0';
                            document.getElementById('dataDistribution').textContent = '无数据';
                            
                            // 清空频率表
                            const tbody = document.querySelector('#frequencyTable tbody');
                            if (tbody) tbody.innerHTML = '';
                            
                            // 清空图表
                            const chartBars = document.getElementById('chartBars');
                            if (chartBars) chartBars.innerHTML = '';
                            
                            const chartLegend = document.getElementById('chartLegend');
                            if (chartLegend) chartLegend.innerHTML = '';
                        }
                        
                        // 计算统计量
                        function calculateStatistics() {
                            const input = document.getElementById('dataInput').value;
                            const data = parseInputData(input);
                            
                            // 更新数据摘要
                            updateDataSummary(data);
                            
                            if (data.length === 0) {
                                clearResults();
                                return;
                            }
                            
                            // 计算算术平均数
                            calculateMean(data);
                            
                            // 计算中位数
                            calculateMedian(data);
                            
                            // 计算众数
                            calculateMode(data);
                            
                            // 生成可视化图表
                            generateChart(data);
                        }
                        
                        // 计算算术平均数
                        function calculateMean(data) {
                            const sum = data.reduce((acc, val) => acc + val, 0);
                            const count = data.length;
                            const mean = sum / count;
                            
                            // 根据结果确定小数位数
                            const meanDecimals = mean % 1 === 0 ? 0 : 2;
                            const meanFormatted = mean.toFixed(meanDecimals);
                            
                            // 生成计算公式
                            const formulaParts = data.slice(0, 5).map(n => n % 1 === 0 ? n : n.toFixed(2));
                            const formula = formulaParts.length < data.length ? 
                                `(${formulaParts.join('+')}+...) ÷ ${count} = ${meanFormatted}` :
                                `(${formulaParts.join('+')}) ÷ ${count} = ${meanFormatted}`;
                            
                            document.getElementById('meanValue').textContent = meanFormatted;
                            document.getElementById('sumValue').textContent = sum.toFixed(2);
                            document.getElementById('countValue').textContent = count;
                            document.getElementById('meanFormula').textContent = formula;
                        }
                        
                        // 计算中位数
                        function calculateMedian(data) {
                            const sorted = [...data].sort((a, b) => a - b);
                            const count = sorted.length;
                            let median;
                            let position;
                            let explanation;
                            
                            if (count % 2 === 1) {
                                // 奇数个数据
                                const middleIndex = Math.floor(count / 2);
                                median = sorted[middleIndex];
                                position = `第${middleIndex + 1}位`;
                                explanation = `数据个数为奇数(${count})，取排序后第${middleIndex + 1}位的数值${median}作为中位数`;
                            } else {
                                // 偶数个数据
                                const middleIndex1 = count / 2 - 1;
                                const middleIndex2 = count / 2;
                                median = (sorted[middleIndex1] + sorted[middleIndex2]) / 2;
                                position = `第${middleIndex1 + 1}位和第${middleIndex2 + 1}位`;
                                explanation = `数据个数为偶数(${count})，取排序后第${middleIndex1 + 1}位(${sorted[middleIndex1]})和第${middleIndex2 + 1}位(${sorted[middleIndex2]})的平均值作为中位数`;
                            }
                            
                            // 根据结果确定小数位数
                            const medianDecimals = median % 1 === 0 ? 0 : 2;
                            const medianFormatted = median.toFixed(medianDecimals);
                            
                            // 限制显示的数据数量
                            const sortedPreview = sorted.slice(0, 10).map(n => n % 1 === 0 ? n : n.toFixed(2));
                            const sortedDisplay = sortedPreview.length < sorted.length ? 
                                sortedPreview.join(', ') + '...' : sortedPreview.join(', ');
                            
                            document.getElementById('medianValue').textContent = medianFormatted;
                            document.getElementById('sortedData').textContent = sortedDisplay;
                            document.getElementById('medianPosition').textContent = position;
                            document.getElementById('medianExplanation').textContent = explanation;
                        }
                        
                        // 计算众数
                        function calculateMode(data) {
                            // 统计频率
                            const frequency = {};
                            data.forEach(value => {
                                const key = value.toString();
                                frequency[key] = (frequency[key] || 0) + 1;
                            });
                            
                            // 找出最高频率
                            const frequencies = Object.values(frequency);
                            const maxFreq = Math.max(...frequencies);
                            
                            // 找出众数（可能有多个）
                            const modes = Object.keys(frequency)
                                .filter(key => frequency[key] === maxFreq)
                                .map(key => parseFloat(key));
                            
                            // 更新结果
                            let modeDisplay, distributionText;
                            
                            if (maxFreq === 1) {
                                modeDisplay = "无（所有数值出现1次）";
                                distributionText = "所有数值出现1次";
                            } else if (modes.length === 1) {
                                modeDisplay = modes[0] % 1 === 0 ? modes[0].toString() : modes[0].toFixed(2);
                                distributionText = `数值 ${modeDisplay} 出现 ${maxFreq} 次`;
                            } else {
                                const modesFormatted = modes.map(m => m % 1 === 0 ? m.toString() : m.toFixed(2)).join(', ');
                                modeDisplay = modesFormatted;
                                distributionText = `多个众数：${modesFormatted}（各出现 ${maxFreq} 次）`;
                            }
                            
                            document.getElementById('modeValue').textContent = modeDisplay;
                            document.getElementById('maxFrequency').textContent = maxFreq;
                            document.getElementById('dataDistribution').textContent = distributionText;
                            
                            // 生成频率分布表
                            generateFrequencyTable(frequency);
                        }
                        
                        // 生成频率分布表
                        function generateFrequencyTable(frequency) {
                            const tbody = document.querySelector('#frequencyTable tbody');
                            tbody.innerHTML = '';
                            
                            // 转换为数组并排序
                            const entries = Object.entries(frequency)
                                .map(([value, count]) => ({
                                    value: parseFloat(value),
                                    count: count
                                }))
                                .sort((a, b) => b.count - a.count || a.value - b.value); // 按频率降序，值升序
                            
                            // 计算总数用于频率百分比
                            const total = entries.reduce((sum, entry) => sum + entry.count, 0);
                            
                            // 生成表格行
                            entries.forEach(entry => {
                                const percentage = ((entry.count / total) * 100).toFixed(1);
                                const row = document.createElement('tr');
                                
                                // 如果是众数，高亮显示
                                const isMode = entry.count === Math.max(...Object.values(frequency));
                                const valueClass = isMode ? 'mode-value' : '';
                                
                                row.innerHTML = `
                                    <td class="${valueClass}">${entry.value % 1 === 0 ? entry.value : entry.value.toFixed(2)}</td>
                                    <td>${entry.count}</td>
                                    <td>${percentage}%</td>
                                `;
                                
                                tbody.appendChild(row);
                            });
                        }
                        
                        // 生成可视化图表
                        function generateChart(data) {
                            const chartBars = document.getElementById('chartBars');
                            const chartLegend = document.getElementById('chartLegend');
                            
                            // 清空现有内容
                            chartBars.innerHTML = '';
                            chartLegend.innerHTML = '';
                            
                            if (data.length === 0) return;
                            
                            // 统计频率（最多显示15个不同的值）
                            const frequency = {};
                            data.forEach(value => {
                                const key = value.toFixed(2); // 保留两位小数作为键
                                frequency[key] = (frequency[key] || 0) + 1;
                            });
                            
                            // 转换为数组并排序
                            const entries = Object.entries(frequency)
                                .map(([value, count]) => ({
                                    value: parseFloat(value),
                                    count: count
                                }))
                                .sort((a, b) => a.value - b.value); // 按值升序排序
                            
                            // 限制显示的数量
                            const displayEntries = entries.slice(0, 15);
                            
                            // 找出最高频率用于缩放
                            const maxCount = Math.max(...displayEntries.map(e => e.count));
                            
                            // 生成柱状图
                            displayEntries.forEach(entry => {
                                const barHeight = (entry.count / maxCount) * 100;
                                const isMode = entry.count === Math.max(...displayEntries.map(e => e.count));
                                const barClass = isMode ? 'chart-bar mode-bar' : 'chart-bar';
                                
                                const bar = document.createElement('div');
                                bar.className = barClass;
                                bar.style.height = `${barHeight}%`;
                                bar.title = `数值: ${entry.value % 1 === 0 ? entry.value : entry.value.toFixed(2)}, 出现次数: ${entry.count}`;
                                chartBars.appendChild(bar);
                            });
                            
                            // 生成图例
                            const mean = data.reduce((a, b) => a + b, 0) / data.length;
                            const sorted = [...data].sort((a, b) => a - b);
                            const median = sorted.length % 2 === 1 ? 
                                sorted[Math.floor(sorted.length / 2)] :
                                (sorted[sorted.length / 2 - 1] + sorted[sorted.length / 2]) / 2;
                            
                            chartLegend.innerHTML = `
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #3b82f6"></div>
                                    <span>算术平均数: ${mean % 1 === 0 ? mean : mean.toFixed(2)}</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #10b981"></div>
                                    <span>中位数: ${median % 1 === 0 ? median : median.toFixed(2)}</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #8b5cf6"></div>
                                    <span>深色柱: 众数（最高频次）</span>
                                </div>
                            `;
                        }
                        
                        // 输入框变化时自动计算
                        function setupAutoCalculation() {
                            const dataInput = document.getElementById('dataInput');
                            dataInput.addEventListener('input', calculateStatistics);
                        }
                        
                        // 主题切换
                        function initTheme() {
                            const themeBtn = document.querySelector('.theme-btn');
                            
                            // 检查本地存储的主题设置
                            const savedTheme = localStorage.getItem('theme') || 'light';
                            if (savedTheme === 'dark') {
                                document.documentElement.setAttribute('data-theme', 'dark');
                            }
                            
                            // 切换主题函数
                            function toggleTheme() {
                                const currentTheme = document.documentElement.getAttribute('data-theme');
                                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                                document.documentElement.setAttribute('data-theme', newTheme);
                                localStorage.setItem('theme', newTheme);
                                
                                // 更新图标
                                if (themeBtn) {
                                    const icon = themeBtn.querySelector('i');
                                    icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
                                }
                            }
                            
                            // 添加事件监听
                            if (themeBtn) themeBtn.addEventListener('click', toggleTheme);
                        }
                        
                        // 初始化
                        document.addEventListener('DOMContentLoaded', () => {
                            initTheme();
                            setupAutoCalculation();
                            
                            // 页面加载时自动计算一次
                            calculateStatistics();
                            
                            // 移动端菜单
                            const menuBtn = document.getElementById('mobileMenuBtn');
                            if (menuBtn) {
                                menuBtn.addEventListener('click', (e) => {
                                    e.preventDefault();
                                    alert('移动端菜单功能需要完整的菜单HTML结构');
                                });
                            }
                        });
                    </script>
                    
                    <style>
                        .tabs {
                            display: flex;
                            border-bottom: 1px solid var(--border-light);
                            margin-bottom: 1.5rem;
                            overflow-x: auto;
                        }
                        
                        .tab {
                            padding: 0.75rem 1.5rem;
                            font-weight: 500;
                            color: var(--text-secondary);
                            text-decoration: none;
                            border: none;
                            background: none;
                            border-bottom: 2px solid transparent;
                            white-space: nowrap;
                            cursor: pointer;
                            transition: all var(--transition);
                        }
                        
                        .tab:hover {
                            color: var(--primary);
                        }
                        
                        .tab.active {
                            color: var(--primary);
                            border-bottom-color: var(--primary);
                        }
                        
                        .data-input-section {
                            margin-bottom: 1.5rem;
                        }
                        
                        .textarea {
                            min-height: 6rem;
                            resize: vertical;
                        }
                        
                        .input-actions {
                            display: flex;
                            gap: 0.5rem;
                            margin: 0.5rem 0;
                        }
                        
                        .data-summary {
                            display: flex;
                            flex-wrap: wrap;
                            gap: 1rem;
                            margin-top: 1rem;
                            padding: 0.75rem;
                            background: var(--bg-secondary);
                            border-radius: var(--radius);
                            border: 1px solid var(--border-light);
                        }
                        
                        .summary-item {
                            display: flex;
                            flex-direction: column;
                        }
                        
                        .summary-label {
                            font-size: 0.875rem;
                            color: var(--text-secondary);
                            margin-bottom: 0.25rem;
                        }
                        
                        .summary-value {
                            font-weight: 600;
                            color: var(--text-primary);
                        }
                        
                        .calculation-formula {
                            background: var(--bg-secondary);
                            border-radius: var(--radius);
                            padding: 1rem;
                            margin: 1rem 0;
                            border-left: 4px solid var(--primary);
                        }
                        
                        .formula-title {
                            font-weight: 600;
                            margin-bottom: 0.5rem;
                            color: var(--text-primary);
                        }
                        
                        .formula {
                            font-family: 'Courier New', monospace;
                            color: var(--primary);
                            font-size: 0.95rem;
                            margin-bottom: 0.25rem;
                        }
                        
                        .frequency-table {
                            margin-top: 1rem;
                        }
                        
                        .frequency-title {
                            font-weight: 600;
                            margin-bottom: 0.75rem;
                            color: var(--text-primary);
                        }
                        
                        .mode-value {
                            color: var(--primary);
                            font-weight: 600;
                        }
                        
                        .data-visualization {
                            background: var(--bg-secondary);
                            border-radius: var(--radius);
                            padding: 1.5rem;
                            border: 1px solid var(--border-light);
                        }
                        
                        .visualization-container {
                            display: flex;
                            flex-direction: column;
                            gap: 1rem;
                            margin-top: 1rem;
                        }
                        
                        @media (min-width: 768px) {
                            .visualization-container {
                                flex-direction: row;
                            }
                        }
                        
                        .simple-chart {
                            flex: 1;
                            min-height: 200px;
                            display: flex;
                            flex-direction: column;
                        }
                        
                        .chart-title {
                            font-weight: 600;
                            margin-bottom: 1rem;
                            color: var(--text-primary);
                        }
                        
                        .chart-bars {
                            flex: 1;
                            display: flex;
                            align-items: flex-end;
                            justify-content: space-around;
                            gap: 0.5rem;
                            padding: 0.5rem;
                            background: var(--bg-primary);
                            border-radius: var(--radius);
                            border: 1px solid var(--border-light);
                        }
                        
                        .chart-bar {
                            flex: 1;
                            background: linear-gradient(to top, var(--primary) 0%, var(--primary-light) 100%);
                            border-radius: var(--radius-sm) var(--radius-sm) 0 0;
                            min-width: 20px;
                            transition: opacity var(--transition);
                        }
                        
                        .chart-bar:hover {
                            opacity: 0.8;
                        }
                        
                        .mode-bar {
                            background: linear-gradient(to top, #8b5cf6 0%, #a78bfa 100%);
                        }
                        
                        .chart-axis {
                            height: 2rem;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            border-top: 1px solid var(--border-light);
                            margin-top: 0.5rem;
                        }
                        
                        .axis-label {
                            color: var(--text-secondary);
                            font-size: 0.875rem;
                        }
                        
                        .chart-legend {
                            min-width: 200px;
                        }
                        
                        .legend-item {
                            display: flex;
                            align-items: center;
                            gap: 0.5rem;
                            margin-bottom: 0.75rem;
                            padding: 0.5rem;
                            background: var(--bg-primary);
                            border-radius: var(--radius);
                            border: 1px solid var(--border-light);
                        }
                        
                        .legend-color {
                            width: 1rem;
                            height: 1rem;
                            border-radius: var(--radius-sm);
                        }
                        
                        .average-types {
                            background: var(--bg-secondary);
                            border-radius: var(--radius-lg);
                            padding: 1.5rem;
                            border: 1px solid var(--border-light);
                        }
                        
                        .types-grid {
                            display: grid;
                            grid-template-columns: 1fr;
                            gap: 1rem;
                            margin-top: 1rem;
                        }
                        
                        @media (min-width: 768px) {
                            .types-grid {
                                grid-template-columns: repeat(3, 1fr);
                            }
                        }
                        
                        .type-item {
                            display: flex;
                            flex-direction: column;
                            padding: 1rem;
                            background: var(--bg-primary);
                            border-radius: var(--radius);
                            border: 1px solid var(--border-light);
                        }
                        
                        .type-icon {
                            width: 3rem;
                            height: 3rem;
                            border-radius: 50%;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            color: white;
                            font-size: 1.25rem;
                            margin-bottom: 0.75rem;
                        }
                        
                        .type-content {
                            flex: 1;
                        }
                        
                        .type-content h4 {
                            font-size: 1rem;
                            margin-bottom: 0.5rem;
                            color: var(--text-primary);
                        }
                        
                        .type-content p {
                            font-size: 0.875rem;
                            color: var(--text-secondary);
                            line-height: 1.4;
                            margin-bottom: 0.5rem;
                        }
                        
                        .type-example {
                            font-size: 0.75rem;
                            color: var(--primary);
                            font-family: 'Courier New', monospace;
                            padding: 0.5rem;
                            background: var(--bg-secondary);
                            border-radius: var(--radius-sm);
                        }
                        
                        .full-width {
                            grid-column: 1 / -1;
                        }
                        
                        @media (max-width: 640px) {
                            .tab {
                                padding: 0.5rem 1rem;
                                font-size: 0.875rem;
                            }
                            
                            .data-summary {
                                flex-direction: column;
                                gap: 0.5rem;
                            }
                        }
                    </style>
                </body>
                </html>